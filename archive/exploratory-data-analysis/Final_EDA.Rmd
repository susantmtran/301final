---
title: "Final EDA"
author: "Grace Park, Susan Tran, Nomi Tannenbaum. Jamie Lee, Alex Chang"
date: "4/25/2021"
output:
  html_document:
    toc: true
    toc_float: true
    theme: paper
    code_folding: hide
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=TRUE, warning=FALSE, message=FALSE, comment=FALSE)
```

# Data Set

```{r}
# load package 
library(lubridate)
library(tidyverse)
library(naniar)

# load data
load("data/movies.RData")
```

Our data set was found on [Kaggle](https://www.kaggle.com/nichen301/movie-data) and contains information about 651 randomly chosen movies produced and released before 2016 including critic data, Academy Award nominations, and main actors/actresses. A few variables of interest are `critics_rating`, `audience_rating`, `top200_box` , `best_actor_win`, `best_actress_win` , and `best_dir_win` which we will be using to predict `best_pic_nom`.

# Exploratory Data Analysis

## Missingness

```{r}
skimr::skim_without_charts(movies)

miss_var_summary(movies)

gg_miss_var(movies, facet = title_type)

gg_miss_upset(movies)
```

The variables with the highest levels of missingness are `actor4` and `actor5`. This is not surprising as some of the films represented in the data set are independently and/or fairly unknown, and therefore would not have the budget nor the need for a larger cast. Understandably, if a film does not have an `actor3`, it would also not have an `actor4` or an `actor5`.

## Trends

```{r}
movies %>% 
  ggplot(aes(title_type)) +
  geom_bar(aes(fill = best_pic_win)) +
  scale_fill_brewer(name = "Won Best Picture?",
                    palette = "Set2",
                    labels = c("NO", "YES")) +
  labs(x = NULL, y = NULL, title = "Representation of Types of Titles") +
  theme_classic() +
  theme(legend.position = "top",
        legend.direction = "horizontal",
        plot.title = element_text(size = 12,
                                  hjust = 0.5,
                                  vjust = 0,
                                  face = "bold"))
```

Fittingly, for our point of analysis of award show winners and losers, feature films are most represented in this data set. We can see that only feature films win the best picture award in the first place, and a very marginal numbers of feature films, at that.

## Notable Elements

```{r}
movies %>% 
  ggplot(aes(best_pic_nom, fill = best_pic_nom)) +
  geom_bar() +
  facet_wrap(~ genre) +
  scale_fill_brewer(name = NULL,
                    palette = "Set2",
                    labels = c("Not Nominated", "Nominated")) +
  labs(x = NULL, y = NULL,
         title = "Best Picture Nominations by Genre") +
  theme_classic() +
  theme(legend.position = "top",
        legend.direction = "horizontal",
        plot.title = element_text(size = 12,
                                  hjust = 0.5,
                                  vjust = 0,
                                  face = "bold"))

movies %>% 
  ggplot(aes(best_pic_win, fill = best_pic_win)) +
  geom_bar() +
  facet_wrap(~ genre) +
  scale_fill_brewer(name = NULL,
                    palette = "Set2",
                    labels = c("Loser", "Winner")) +
  labs(x = NULL, y = NULL,
         title = "Best Picture Wins by Genre") +
  theme_classic() +
  theme(legend.position = "top",
        legend.direction = "horizontal",
        plot.title = element_text(size = 12,
                                  hjust = 0.5,
                                  vjust = 0,
                                  face = "bold"))
```

Looking at the faceted graphs above, we find that films in the `drama` genre will likely be the most essential observations in our greater analysis of the Academy Awards.

```{r}
movies %>% 
ggplot(aes(title_type)) +
  geom_bar(aes(fill = best_pic_win)) + 
  scale_fill_brewer(name = NULL,
                    palette = "Set2",
                    labels = c("Loser", "Winner")) + 
  labs(x = NULL, y = NULL, title = "Best Picture Win by Title Type") + 
  theme_classic()
```

This bar chart reveals that most of the films that win best picture are feature films, rather than documentaries and TV movies. 

```{r}
movies %>% 
  ggplot(aes(best_pic_nom, fill = best_pic_nom)) +
  geom_bar(position = "dodge") +
  facet_wrap(~mpaa_rating) +
  scale_fill_brewer(name = NULL,
                  palette = "Set2",
                  labels = c("Not Nominated", "Nominated")) +
  labs(x = NULL, y = NULL,
       title = "Best Picture Nominations by Rating") +
  theme_classic() +
  theme(legend.position = "top",
        legend.direction = "horizontal",
        plot.title = element_text(size = 12,
                                  hjust = 0.5,
                                  vjust = 0,
                                  face = "bold"))
```

This plot portrays that there are a lot of R-rated films represented in this dataset; this rating category has the most pictures not nominated as well as nominated.

```{r}
movies_1 <- movies %>% 
  mutate(thtr_rel_month = month(thtr_rel_month, label = TRUE))

movies_1 %>% 
  ggplot(aes(
    x = thtr_rel_month,
    fill = best_pic_nom
  )) +
  geom_bar(position = "stack") +
  scale_fill_brewer(name = NULL,
                    palette = "Set2",
                    labels = c("Not Nominated", "Nominated")) +
  labs(x = NULL, y = NULL,
       title = "Best Picture Nominations by Month Released in Theaters") +
  theme_classic() +
  theme(legend.position = "top",
        legend.direction = "horizontal",
        plot.title = element_text(size = 12,
                                  hjust = 0.5,
                                  vjust = 0,
                                  face = "bold"))
```

Above, we see that movies that were released in theaters in December had the most nominations in comparison to other months; this may be due to the fact that the Oscars typically takes place near the end of the year. 

# Conclusion

Wrapping up our analysis, we find that there is a small proportion of movies in this data set that have won Academy Awards. This ratio is unsurprising since so few movies are nominated for Academy Awards in comparison to the volume of movies produced. To combat this, we are considering merging all nomination categories. In this way we will have one variable to represent all possible award categories and then have a larger proportion of movies that fall into this variable.